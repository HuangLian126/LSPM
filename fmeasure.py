import numpy as np 
import torch

def calculateF1Measure(output_image,gt_image,thre):
    output_image = np.squeeze(output_image)
    gt_image     = np.squeeze(gt_image)
    # print(gt_image)
    out_bin      = output_image>thre
    gt_bin       = gt_image>thre

    recall       = np.sum(gt_bin*out_bin)/np.maximum(1, np.sum(gt_bin))
    prec         = np.sum(gt_bin*out_bin)/np.maximum(1, np.sum(out_bin))
    F1 = 2*recall*prec/np.maximum(0.001, recall+prec)
    return F1